#! /usr/bin/env bash

if [[ -z "${IN_GHOSTTY_FLOAT:-}" ]]; then
  export IN_GHOSTTY_FLOAT=1
  exec open-ghostty -fs "$(realpath "$0")" "$@"
fi

profile=$(
  tuned-adm list |
    grep '^-' |
    sed 's/^- //' |
    awk -F ' - ' '{print $1 "\t" $2}' |
    fzf --style=minimal --delimiter='\t' --with-nth=1 --preview='echo {2}' |
    cut -f1
)

[[ $profile ]] || exit
notify-send "Power Profile: $profile"
tuned-adm profile $profile
